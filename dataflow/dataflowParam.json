{
	"name": "dataflowParam",
	"properties": {
		"folder": {
			"name": "Parametrizacion"
		},
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "carpetaCSV",
						"type": "DatasetReference"
					},
					"name": "CSV"
				},
				{
					"dataset": {
						"referenceName": "carpetaXLSX",
						"type": "DatasetReference"
					},
					"name": "XLSX"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "Parquet",
						"type": "DatasetReference"
					},
					"name": "sink1",
					"rejectedDataLinkedService": {
						"referenceName": "AzureDataLakeStorageEjercitacion1",
						"type": "LinkedServiceReference"
					}
				}
			],
			"transformations": [
				{
					"name": "millid1"
				},
				{
					"name": "select1"
				},
				{
					"name": "select2"
				},
				{
					"name": "millid"
				},
				{
					"name": "select3"
				}
			],
			"scriptLines": [
				"source(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false) ~> CSV",
				"source(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false) ~> XLSX",
				"XLSX filter(mill_id =='1') ~> millid1",
				"CSV select(mapColumn(",
				"          Mill_Id,",
				"          Order_Number,",
				"          Order_Item,",
				"          Order_Item_Creation_Date,",
				"          Product_Code,",
				"          Requested_Tn_Qty,",
				"          Segment_Id,",
				"          Invoicing_Customer_Id,",
				"          Production_Order_Key,",
				"          COMM_ORDER_ITM_ID,",
				"          COMM_DOC_LOCATION_CODE,",
				"          COMM_DOC_YEAR,",
				"          COMM_DOC_MONTH,",
				"          COMM_DOC_TYPE,",
				"          COMM_DOC_NUMBER,",
				"          COMM_DOC_ITEM_NUM,",
				"          RFD_Type,",
				"          Order_Rolling_Date,",
				"          Order_Aging_Rolling_Date,",
				"          Order_RFD_Date,",
				"          Order_Aging_RFD_Date,",
				"          Order_Reception_Date,",
				"          Order_Reception_Aging_Date,",
				"          Order_First_Process_Date,",
				"          Order_First_Process_Aging_Date,",
				"          rnd_flag",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select1",
				"millid1 select(mapColumn(",
				"          stock_record_key,",
				"          mill_id,",
				"          data_source_origin,",
				"          stock_date,",
				"          process_date,",
				"          shift_number,",
				"          storage_type,",
				"          storage_unit_code,",
				"          heat_key,",
				"          mill_production_order_item_key,",
				"          work_order_key,",
				"          local_product_code,",
				"          local_product_type,",
				"          stock_type,",
				"          stock_ft_qty,",
				"          caliber_steel,",
				"          steel_code,",
				"          SurrogateKey",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select2",
				"select2, select1 join(select2@mill_id == select1@Mill_Id,",
				"     joinType:'inner',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> millid",
				"millid select(mapColumn(",
				"          stock_record_key,",
				"          data_source_origin,",
				"          stock_date,",
				"          process_date,",
				"          shift_number,",
				"          storage_type,",
				"          storage_unit_code,",
				"          heat_key,",
				"          mill_production_order_item_key,",
				"          work_order_key,",
				"          local_product_code,",
				"          local_product_type,",
				"          stock_type,",
				"          stock_ft_qty,",
				"          caliber_steel,",
				"          steel_code,",
				"          SurrogateKey,",
				"          Mill_Id = select1@Mill_Id,",
				"          Order_Number,",
				"          Order_Item,",
				"          Order_Item_Creation_Date,",
				"          Product_Code,",
				"          Requested_Tn_Qty,",
				"          Segment_Id,",
				"          Invoicing_Customer_Id",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select3",
				"select3 sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     input(",
				"          Mill_Id as string,",
				"          Order_Number as string,",
				"          Order_Item as string,",
				"          Order_Item_Creation_Date as string,",
				"          Product_Code as string,",
				"          Requested_Tn_Qty as string,",
				"          Segment_Id as string,",
				"          Invoicing_Customer_Id as string,",
				"          Production_Order_Key as string,",
				"          COMM_ORDER_ITM_ID as string,",
				"          COMM_DOC_LOCATION_CODE as string,",
				"          COMM_DOC_YEAR as string,",
				"          COMM_DOC_MONTH as string,",
				"          COMM_DOC_TYPE as string,",
				"          COMM_DOC_NUMBER as string,",
				"          COMM_DOC_ITEM_NUM as string,",
				"          RFD_Type as string,",
				"          Order_Rolling_Date as string,",
				"          Order_Aging_Rolling_Date as string,",
				"          Order_RFD_Date as string,",
				"          Order_Aging_RFD_Date as string,",
				"          Order_Reception_Date as string,",
				"          Order_Reception_Aging_Date as string,",
				"          Order_First_Process_Date as string,",
				"          Order_First_Process_Aging_Date as string,",
				"          rnd_flag as string",
				"     ),",
				"     format: 'parquet',",
				"     umask: 0022,",
				"     preCommands: [],",
				"     postCommands: [],",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> sink1"
			]
		}
	}
}