{
	"name": "dataflowParams",
	"properties": {
		"folder": {
			"name": "Parametrizacion"
		},
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "carpetaXLSX",
						"type": "DatasetReference"
					},
					"name": "XLSXparams"
				},
				{
					"dataset": {
						"referenceName": "carpetaCSV",
						"type": "DatasetReference"
					},
					"name": "CSVSparams"
				}
			],
			"sinks": [],
			"transformations": [
				{
					"name": "millid1"
				},
				{
					"name": "select2"
				},
				{
					"name": "select3"
				}
			],
			"scriptLines": [
				"source(output(",
				"          stock_record_key as string,",
				"          mill_id as string,",
				"          data_source_origin as string,",
				"          stock_date as date,",
				"          process_date as double,",
				"          shift_number as short,",
				"          storage_type as string,",
				"          storage_unit_code as string,",
				"          heat_key as string,",
				"          mill_production_order_item_key as string,",
				"          work_order_key as integer,",
				"          local_product_code as integer,",
				"          local_product_type as string,",
				"          stock_type as string,",
				"          local_material_status as short,",
				"          stock_classification as string,",
				"          location_type as string,",
				"          location_code as string,",
				"          production_line_id as string,",
				"          warehouse_key as short,",
				"          machine_id as string,",
				"          rfd_flag as string,",
				"          stock_in_process_flag as string,",
				"          origin_rolling_mill as string,",
				"          aging_date as integer,",
				"          aging_date_name as string,",
				"          aging_flag as string,",
				"          stock_mt_qty as double,",
				"          stock_pc_qty as short,",
				"          stock_tn_qty as double,",
				"          stock_kg_qty as double,",
				"          stock_nominal_tn_qty as string,",
				"          stock_ft_qty as double,",
				"          caliber_steel as string,",
				"          steel_code as string,",
				"          length_steel as string,",
				"          tenaris_property_flag as string,",
				"          origin_mill as string,",
				"          Heat_Date as string,",
				"          Order_Heat_Rolling_Date as string,",
				"          Order_Rolling_Date as string,",
				"          Order_Aging_Rolling_Date as string,",
				"          Order_RFD_Date as string,",
				"          Order_Aging_RFD_Date as string,",
				"          Order_Reception_Date as string,",
				"          Order_Reception_Aging_Date as string,",
				"          Order_First_Process_Date as string,",
				"          Order_First_Process_Aging_Date as string,",
				"          RFD_Type as string,",
				"          Local_material_status_sub_type as string,",
				"          SurrogateKey as integer,",
				"          local_material_status_cost as short,",
				"          Imported_material_flag as string,",
				"          bill_and_hold_flag as string",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false) ~> XLSXparams",
				"source(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false) ~> CSVSparams",
				"XLSXparams filter(mill_id=='1') ~> millid1",
				"millid1 select(mapColumn(",
				"          stock_record_key,",
				"          mill_id,",
				"          data_source_origin,",
				"          stock_date,",
				"          process_date,",
				"          shift_number,",
				"          storage_type,",
				"          storage_unit_code,",
				"          heat_key,",
				"          mill_production_order_item_key,",
				"          work_order_key,",
				"          local_product_code,",
				"          local_product_type,",
				"          stock_type,",
				"          local_material_status,",
				"          stock_nominal_tn_qty,",
				"          stock_ft_qty,",
				"          caliber_steel,",
				"          steel_code",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select2",
				"CSVSparams select(skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select3"
			]
		}
	}
}